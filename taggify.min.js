(function(e,t){"use strict";e.Taggify=function(a){var n="taggify",l=n+"__wrapper",i=l+"__input",r=l+"__label",s=l+"__results",c=n+"__tags",u=c+"__tag",o=u+"__label",d=u+"__remove",p="."+n,f="div",m=188,L=13,h=function(e,t){t(e)},b={containerSelector:p,autocomplete:false,autocompleteCallback:h,inputDelay:100,inputLabel:"Start typing ...",allowDuplicates:false,hotKeys:[m,L]},g=n+"-"+Date.now(),v=t.createElement("input"),_=t.createElement("label"),C=t.createElement(f),y=t.createElement(f),E=t.createElement(f),w,T,D,k,H=function(e){var t={},a=b.hotKeys.some(function(t){return(e.keyCode||e.which)===t}),n;if(a){n=e.target.value.split(",").map(function(e,t){return{id:t,label:e.trim()}}).filter(function(e){if(!b.allowDuplicates){if(!e.label.length||t[e.label]){return false}t[e.label]=true;return e}else{return!!e.label.length}});e.target.value=n.map(function(e){return e.label}).join(", ")+", ";S(n)}},M=function(t){e.clearTimeout(k);k=e.setTimeout(function(){if(b.autocomplete){b.autocompleteCallback(t.target.value,S)}else{H(t)}},b.inputDelay)},S=function(e){var a=t.createDocumentFragment();e.forEach(function(e){var n=t.createElement(f),l=t.createElement("span"),i=t.createElement("button");l.classList.add(o);l.innerHTML=e.label;i.classList.add(d);n.classList.add(u);n.dataset.tagText=e.label;n.dataset.tagId=e.id;n.appendChild(l);n.appendChild(i);a.appendChild(n)});D=e;if(!b.autocomplete){C.innerHTML=""}else{v.value=""}C.appendChild(a)},j=function(e,t){var a=e.parentNode;if(!a){return undefined}if(t(e)){return e}return t(a)?a:j(a,t)},x=function(e){return e.classList&&e.classList.contains(u)},I=function(e){return e.classList&&e.classList.contains(d)},K=function(e){var t=j(e.target,I),a="",n;if(t){n=j(e.target,x);D=D.filter(function(e){var t=""+e.id,a=""+n.dataset.tagId;return t!==a});if(!b.autocomplete){a=D.map(function(e){return e.label}).join(", ")+", "}v.value=a;this.removeChild(n)}};for(w in a){if(a.hasOwnProperty(w)){b[w]=a[w]}}T=t.querySelector(b.containerSelector);T.innerHTML="";E.classList.add(l);_.for=g;_.innerHTML=b.inputLabel;_.setAttribute("for",g);_.classList.add(r);v.id=g;v.type="text";v.classList.add(i);y.classList.add(s);C.classList.add(c);T.appendChild(E);T.appendChild(C);E.appendChild(_);E.appendChild(v);E.appendChild(y);v.addEventListener("keyup",M,false);C.addEventListener("click",K,false)}})(window,window.document);