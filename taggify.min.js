(function(e,t){"use strict";e.Taggify=function(a){var n="taggify",l=n+"__wrapper",i=l+"__input",r=l+"__label",c=l+"__results",s=n+"__tags",o=s+"__tag",u=o+"__label",d=o+"__remove",p="."+n,f="div",m=188,h=13,g=function(e,t){t(e)},L={containerSelector:p,autocomplete:false,autocompleteCallback:g,inputDelay:100,inputPlaceholder:"Start typing ...",allowDuplicates:false},v=n+"-"+Date.now(),b=t.createElement("input"),_=t.createElement("label"),C=t.createElement(f),w=t.createElement(f),y=t.createElement(f),E,T,k,D,H=function(e){var t={},a;if((e.keyCode||e.which)===m||(e.keyCode||e.which)===h){a=e.target.value.split(",").map(function(e,t){return{id:t,label:e.trim()}}).filter(function(e){if(!L.allowDuplicates){if(!e.label.length||t[e.label]){return false}t[e.label]=true;return e}else{return!!e.label.length}});e.target.value=a.map(function(e){return e.label}).join(", ")+", ";S(a)}},M=function(t){e.clearTimeout(D);D=e.setTimeout(function(){if(L.autocomplete){L.autocompleteCallback(t.target.value,S)}else{H(t)}},L.inputDelay)},S=function(e){var a=t.createDocumentFragment();e.forEach(function(e){var n=t.createElement(f),l=t.createElement("span"),i=t.createElement("button");l.classList.add(u);l.innerHTML=e.label;i.classList.add(d);n.classList.add(o);n.dataset.tagText=e.label;n.dataset.tagId=e.id;n.appendChild(l);n.appendChild(i);a.appendChild(n)});k=e;if(!L.autocomplete){C.innerHTML=""}else{b.value=""}C.appendChild(a)},P=function(e,t){var a=e.parentNode;if(!a){return undefined}if(t(e)){return e}return t(a)?a:P(a,t)},j=function(e){return e.classList&&e.classList.contains(o)},x=function(e){return e.classList&&e.classList.contains(d)},I=function(e){var t=P(e.target,x),a="",n;if(t){n=P(e.target,j);k=k.filter(function(e){var t=""+e.id,a=""+n.dataset.tagId;return t!==a});if(!L.autocomplete){a=k.map(function(e){return e.label}).join(", ")+", "}b.value=a;this.removeChild(n)}};for(E in a){if(a.hasOwnProperty(E)){L[E]=a[E]}}T=t.querySelector(L.containerSelector);T.innerHTML="";y.classList.add(l);_.for=v;_.innerHTML=L.inputPlaceholder;_.setAttribute("for",v);_.classList.add(r);b.id=v;b.type="text";b.classList.add(i);w.classList.add(c);C.classList.add(s);T.appendChild(y);T.appendChild(C);y.appendChild(_);y.appendChild(b);y.appendChild(w);b.addEventListener("keyup",M,false);C.addEventListener("click",I,false)}})(window,window.document);